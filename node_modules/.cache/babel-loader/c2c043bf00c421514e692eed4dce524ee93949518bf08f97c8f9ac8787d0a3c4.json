{"ast":null,"code":"import { doc, onSnapshot, setDoc, deleteDoc, collection } from 'firebase/firestore';\nimport db from '../utilities/firebase.js';\nimport { storage } from \"../utilities/firebase.js\";\nimport { ref, uploadBytes, deleteObject } from \"firebase/storage\";\nimport { useCollection } from 'vuefire';\nexport default {\n  name: 'UDHome',\n  components: {},\n  setup() {\n    const todos = useCollection(collection(db, 'home'));\n    console.log(Object.keys(todos).length);\n    return {\n      todos\n    };\n  },\n  data() {\n    return {\n      jumlahHome: '',\n      nama: '',\n      uploading: false\n    };\n  },\n  created() {\n    this.getHome();\n  },\n  methods: {\n    getHome() {\n      onSnapshot(doc(db, \"jumlah\", \"jumlah_home\"), doc => {\n        this.jumlahHome = doc.data().jumlah;\n      });\n    },\n    async addHome() {\n      this.uploading = true;\n      if (this.nama == '' || this.$refs.homebaru.value == null || this.$refs.homebaru.value == \"\") {\n        alert('nilai tidak dapat kosong');\n        this.uploading = false;\n      } else {\n        // add new alumni \n        await setDoc(doc(db, \"jumlah\", \"jumlah_home\"), {\n          jumlah: this.jumlahHome + 1\n        }, {\n          merge: true\n        });\n        let x = this.jumlahHome.toString();\n        await setDoc(doc(db, \"home\", x), {\n          nama: this.nama\n        }, {\n          merge: true\n        });\n        const storageRef = ref(storage, 'home/' + x);\n        uploadBytes(storageRef, this.$refs.homebaru.files[0]).then(() => {\n          console.log(\"new home image uploaded\");\n        });\n        this.nama = \"\", this.$refs.homebaru.value = null;\n        alert('new home image uploaded');\n        this.uploading = false;\n      }\n    },\n    async deletePrestasi(y, home) {\n      if (confirm('menghapus:  ' + home.toUpperCase()) == true) {\n        let z = y.toString();\n        await deleteDoc(doc(db, \"home\", z));\n        deleteObject(ref(storage, 'home/' + z)).then(() => {\n          // File deleted successfully\n        }).catch(error => {\n          console.log(error);\n          alert('gagal, silahkan coba lagi');\n        });\n      }\n    }\n  }\n};","map":{"version":3,"names":["doc","onSnapshot","setDoc","deleteDoc","collection","db","storage","ref","uploadBytes","deleteObject","useCollection","name","components","setup","todos","console","log","Object","keys","length","data","jumlahHome","nama","uploading","created","getHome","methods","jumlah","addHome","$refs","homebaru","value","alert","merge","x","toString","storageRef","files","then","deletePrestasi","y","home","confirm","toUpperCase","z","catch","error"],"sources":["D:\\rafi\\koding\\vue3\\WEBIOT\\iotub\\src\\views\\UDHome.vue"],"sourcesContent":["<template>\r\n    <div class=\"flex justify-center flex-col items-center w-full\">\r\n      <div class=\" pt-10 pb-5\">\r\n        <section class=\" text-3xl\">GAMBAR HOME PAGE</section>\r\n      </div>\r\n      <div>\r\n        <section class=\" text-lg font-bold py-2\">Tambahkan Foto Home Baru</section>\r\n        <section class=\"flex flex-col items-center justify-center\">\r\n          <div class=\"flex flex-col\">\r\n            <div class=\" my-1 flex justify-between\">\r\n              <span>label foto: </span>\r\n               <input v-model=\"nama\" type=\"text\" placeholder=\"foto cangar 2022 ...\" class=\"px-1 border border-black\" alt=\"\">\r\n            </div>\r\n            <div class=\" my-1 flex justify-between flex-col\">\r\n              <div>\r\n                <span>upload foto </span> <span class=\" text-sm text-red-600 font-semibold\"> (foto rasio 3:2) </span>\r\n              </div>\r\n              <input type=\"file\" accept=\"image/*\" class=\" border border-black\" ref=\"homebaru\">\r\n            </div>\r\n            <button @click=\"addHome\" :disabled=\"uploading == true\" class=\" bg-gray-300 px-2 py-1 mt-10 border-black border my-1 hover:bg-slate-200\">\r\n              <span v-if=\"uploading == true\">loading...</span>\r\n              <span v-if=\"uploading == false\">upload</span> \r\n            </button>\r\n          </div>\r\n        </section>\r\n      </div>\r\n      <div class=\"mt-6 md:mt-10 md:w-3/4 w-full\">\r\n        <section class=\" text-lg font-bold py-2\">Hapus Foto</section>\r\n        <section class=\"flex flex-col items-center justify-center\">\r\n          <div class=\"flex flex-col md:w-1/2\">\r\n            <div v-for=\"todo in todos\" :key=\"todo.id\" class=\"w-full border border-black my-4 p-1 flex flex-col justify-start items-start\">\r\n              <div>\r\n                <span>nama gambar: </span>\r\n                <span>{{ todo.nama }}</span>\r\n              </div>\r\n               <button @click=\"deletePrestasi(todo.id, todo.nama)\" class=\"mt-4 w-3/4 self-center text-center bg-red-300 hover:bg-red-400\">hapus</button>\r\n            </div>\r\n        </div>\r\n        </section>\r\n      </div>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import { doc, onSnapshot, setDoc, deleteDoc, collection } from 'firebase/firestore'\r\n  import db from '../utilities/firebase.js'\r\n  import {storage} from \"../utilities/firebase.js\"\r\n  import { ref, uploadBytes, deleteObject} from \"firebase/storage\"\r\n  import { useCollection } from 'vuefire'\r\n  \r\n  export default{\r\n    name:'UDHome',\r\n    components:{\r\n  \r\n    },\r\n    setup(){\r\n      const todos = useCollection(collection(db, 'home'));\r\n      console.log(Object.keys(todos).length);\r\n      return{todos}\r\n    },\r\n\r\n    data(){\r\n      return{\r\n        jumlahHome: '',\r\n        nama: '',\r\n        uploading: false,\r\n      };\r\n    },\r\n    created() {\r\n      this.getHome()\r\n    },\r\n    \r\n    methods:{\r\n      getHome(){\r\n        onSnapshot(doc(db, \"jumlah\", \"jumlah_home\"), (doc) => {\r\n          this.jumlahHome = doc.data().jumlah;\r\n        });\r\n      },\r\n\r\n      async addHome() {\r\n          this.uploading = true;\r\n          if (this.nama == '' || this.$refs.homebaru.value == null || this.$refs.homebaru.value == \"\") {\r\n            alert('nilai tidak dapat kosong');\r\n            this.uploading = false\r\n          }else{\r\n            // add new alumni \r\n            await setDoc(doc(db, \"jumlah\", \"jumlah_home\"), {\r\n                jumlah: this.jumlahHome + 1\r\n            }, { merge: true });\r\n          \r\n            let x = (this.jumlahHome).toString();\r\n            await setDoc(doc(db, \"home\", x), {\r\n                nama: this.nama,\r\n            }, { merge: true });\r\n          \r\n            const storageRef = ref(storage, 'home/'+x);\r\n            uploadBytes(storageRef, this.$refs.homebaru.files[0]).then(()=>{console.log(\"new home image uploaded\")})\r\n            this.nama= \"\",\r\n            this.$refs.homebaru.value = null;\r\n\r\n            alert('new home image uploaded')\r\n            this.uploading = false\r\n          } \r\n      },\r\n      async deletePrestasi(y, home){  \r\n        if (confirm('menghapus:  ' + home.toUpperCase()) == true) {\r\n          let z = y.toString()\r\n          await deleteDoc(doc(db, \"home\", z))\r\n          deleteObject(ref(storage, 'home/'+z)).then(() => {\r\n              // File deleted successfully\r\n          }).catch((error) => {\r\n              console.log(error);\r\n              alert('gagal, silahkan coba lagi');\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n  </script>"],"mappings":"AA4CE,SAASA,GAAG,EAAEC,UAAU,EAAEC,MAAM,EAAEC,SAAS,EAAEC,UAAS,QAAS,oBAAmB;AAClF,OAAOC,EAAC,MAAO,0BAAyB;AACxC,SAAQC,OAAO,QAAO,0BAAyB;AAC/C,SAASC,GAAG,EAAEC,WAAW,EAAEC,YAAY,QAAO,kBAAiB;AAC/D,SAASC,aAAY,QAAS,SAAQ;AAEtC,eAAc;EACZC,IAAI,EAAC,QAAQ;EACbC,UAAU,EAAC,CAEX,CAAC;EACDC,KAAKA,CAAA,EAAE;IACL,MAAMC,KAAI,GAAIJ,aAAa,CAACN,UAAU,CAACC,EAAE,EAAE,MAAM,CAAC,CAAC;IACnDU,OAAO,CAACC,GAAG,CAACC,MAAM,CAACC,IAAI,CAACJ,KAAK,CAAC,CAACK,MAAM,CAAC;IACtC,OAAM;MAACL;IAAK;EACd,CAAC;EAEDM,IAAIA,CAAA,EAAE;IACJ,OAAM;MACJC,UAAU,EAAE,EAAE;MACdC,IAAI,EAAE,EAAE;MACRC,SAAS,EAAE;IACb,CAAC;EACH,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,OAAO,CAAC;EACf,CAAC;EAEDC,OAAO,EAAC;IACND,OAAOA,CAAA,EAAE;MACPxB,UAAU,CAACD,GAAG,CAACK,EAAE,EAAE,QAAQ,EAAE,aAAa,CAAC,EAAGL,GAAG,IAAK;QACpD,IAAI,CAACqB,UAAS,GAAIrB,GAAG,CAACoB,IAAI,CAAC,CAAC,CAACO,MAAM;MACrC,CAAC,CAAC;IACJ,CAAC;IAED,MAAMC,OAAOA,CAAA,EAAG;MACZ,IAAI,CAACL,SAAQ,GAAI,IAAI;MACrB,IAAI,IAAI,CAACD,IAAG,IAAK,EAAC,IAAK,IAAI,CAACO,KAAK,CAACC,QAAQ,CAACC,KAAI,IAAK,IAAG,IAAK,IAAI,CAACF,KAAK,CAACC,QAAQ,CAACC,KAAI,IAAK,EAAE,EAAE;QAC3FC,KAAK,CAAC,0BAA0B,CAAC;QACjC,IAAI,CAACT,SAAQ,GAAI,KAAI;MACvB,CAAC,MAAI;QACH;QACA,MAAMrB,MAAM,CAACF,GAAG,CAACK,EAAE,EAAE,QAAQ,EAAE,aAAa,CAAC,EAAE;UAC3CsB,MAAM,EAAE,IAAI,CAACN,UAAS,GAAI;QAC9B,CAAC,EAAE;UAAEY,KAAK,EAAE;QAAK,CAAC,CAAC;QAEnB,IAAIC,CAAA,GAAK,IAAI,CAACb,UAAU,CAAEc,QAAQ,CAAC,CAAC;QACpC,MAAMjC,MAAM,CAACF,GAAG,CAACK,EAAE,EAAE,MAAM,EAAE6B,CAAC,CAAC,EAAE;UAC7BZ,IAAI,EAAE,IAAI,CAACA;QACf,CAAC,EAAE;UAAEW,KAAK,EAAE;QAAK,CAAC,CAAC;QAEnB,MAAMG,UAAS,GAAI7B,GAAG,CAACD,OAAO,EAAE,OAAO,GAAC4B,CAAC,CAAC;QAC1C1B,WAAW,CAAC4B,UAAU,EAAE,IAAI,CAACP,KAAK,CAACC,QAAQ,CAACO,KAAK,CAAC,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,MAAI;UAACvB,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAC;QAAA,CAAC;QACvG,IAAI,CAACM,IAAI,GAAE,EAAE,EACb,IAAI,CAACO,KAAK,CAACC,QAAQ,CAACC,KAAI,GAAI,IAAI;QAEhCC,KAAK,CAAC,yBAAyB;QAC/B,IAAI,CAACT,SAAQ,GAAI,KAAI;MACvB;IACJ,CAAC;IACD,MAAMgB,cAAcA,CAACC,CAAC,EAAEC,IAAI,EAAC;MAC3B,IAAIC,OAAO,CAAC,cAAa,GAAID,IAAI,CAACE,WAAW,CAAC,CAAC,KAAK,IAAI,EAAE;QACxD,IAAIC,CAAA,GAAIJ,CAAC,CAACL,QAAQ,CAAC;QACnB,MAAMhC,SAAS,CAACH,GAAG,CAACK,EAAE,EAAE,MAAM,EAAEuC,CAAC,CAAC;QAClCnC,YAAY,CAACF,GAAG,CAACD,OAAO,EAAE,OAAO,GAACsC,CAAC,CAAC,CAAC,CAACN,IAAI,CAAC,MAAM;UAC7C;QAAA,CACH,CAAC,CAACO,KAAK,CAAEC,KAAK,IAAK;UAChB/B,OAAO,CAACC,GAAG,CAAC8B,KAAK,CAAC;UAClBd,KAAK,CAAC,2BAA2B,CAAC;QACtC,CAAC,CAAC;MACJ;IACF;EACF;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}