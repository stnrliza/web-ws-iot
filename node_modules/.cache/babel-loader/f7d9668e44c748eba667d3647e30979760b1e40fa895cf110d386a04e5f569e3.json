{"ast":null,"code":"import { doc, setDoc, deleteDoc, collection, onSnapshot } from 'firebase/firestore';\nimport db from '../utilities/firebase.js';\nimport { storage } from \"../utilities/firebase.js\";\nimport { ref, uploadBytes, deleteObject } from \"firebase/storage\";\nimport { useCollection } from 'vuefire';\nexport default {\n  name: 'UDAlumni',\n  components: {},\n  setup() {\n    const todos = useCollection(collection(db, 'alumni'));\n    console.log(Object.keys(todos).length);\n    return {\n      todos\n    };\n  },\n  data() {\n    return {\n      jumlahAlumni: '',\n      nama: '',\n      panggilan: '',\n      angkatan: '',\n      kesan: '',\n      quotes: '',\n      jabatan: '',\n      uploading: false\n    };\n  },\n  created() {\n    this.getAlumni();\n  },\n  methods: {\n    getAlumni() {\n      onSnapshot(doc(db, \"jumlah\", \"jumlah_alumni\"), doc => {\n        this.jumlahAlumni = doc.data().jumlah;\n      });\n    },\n    async addAlumni() {\n      this.uploading = true;\n      if (this.nama == \" \" || this.panggilan == '' || this.angkatan == '' || this.kesan == '' || this.$refs.alumnibaru.value == null || this.$refs.alumnibaru.value == \"\") {\n        alert('nilai tidak dapat kosong');\n        this.uploading = false;\n      } else if (this.$refs.alumnibaru.files[0].size > 800 * 800) {\n        //e.preventDefault();\n        alert('File terlalu besar (> 800Kb)');\n        this.uploading = false;\n      } else {\n        // add new alumni \n        await setDoc(doc(db, \"jumlah\", \"jumlah_alumni\"), {\n          jumlah: this.jumlahAlumni + 1\n        }, {\n          merge: true\n        });\n        let x = this.jumlahAlumni.toString();\n        await setDoc(doc(db, \"alumni\", x), {\n          nama: this.nama,\n          panggilan: this.panggilan,\n          angkatan: this.angkatan,\n          potong: this.angkatan.toString().slice(-2),\n          kesan: this.kesan,\n          quotes: this.quotes,\n          jabatan: this.jabatan\n        }, {\n          merge: true\n        });\n        const storageRef = ref(storage, 'alumni/' + x);\n        uploadBytes(storageRef, this.$refs.alumnibaru.files[0]).then(() => {\n          console.log(\"uploaded\");\n        });\n        this.nama = \"\", this.panggilan = '', this.angkatan = '';\n        this.kesan = '';\n        this.quotes = '';\n        this.jabatan = '';\n        this.$refs.alumnibaru.value = null;\n        alert('new alumni uploaded');\n        this.uploading = false;\n      }\n    },\n    async deleteAlumni(y, nama) {\n      if (confirm('menghapus:  ' + nama.toUpperCase()) == true) {\n        let z = y.toString();\n        await deleteDoc(doc(db, \"alumni\", z));\n        deleteObject(ref(storage, 'alumni/' + z)).then(() => {\n          // File deleted successfully\n        }).catch(error => {\n          console.log(error);\n          alert('gagal, silahkan coba lagi');\n        });\n      }\n    }\n  }\n};","map":{"version":3,"names":["doc","setDoc","deleteDoc","collection","onSnapshot","db","storage","ref","uploadBytes","deleteObject","useCollection","name","components","setup","todos","console","log","Object","keys","length","data","jumlahAlumni","nama","panggilan","angkatan","kesan","quotes","jabatan","uploading","created","getAlumni","methods","jumlah","addAlumni","$refs","alumnibaru","value","alert","files","size","merge","x","toString","potong","slice","storageRef","then","deleteAlumni","y","confirm","toUpperCase","z","catch","error"],"sources":["D:\\rafi\\koding\\vue3\\WEBIOT\\iotub\\IOTUB1-main\\src\\views\\UDAlumni.vue"],"sourcesContent":["<template>\n    <div class=\" md:w-1/2\">\n      <div class=\" pt-10 pb-5\">\n        <section class=\" text-3xl\">ALUMNI</section>\n      </div>\n      <div>\n        <section class=\" text-lg font-bold py-2\">Tambahkan Alumni Baru</section>\n        <section class=\"flex flex-col items-center justify-center\">\n          <div class=\"flex flex-col\">\n            <div class=\" my-1 flex justify-between\">\n              <span>nama: </span>\n               <input v-model=\"this.nama\" type=\"text\" placeholder=\"masukkan nama lengkap....\" class=\"px-1 border border-black text-sm\" alt=\"\">\n            </div>\n            <div class=\" my-1 flex justify-between\">\n              <span>panggilan: </span>\n               <input v-model=\"this.panggilan\" type=\"text\" placeholder=\"masukkan nama panggilan....\" class=\"px-1 border border-black text-sm\" alt=\"\">\n            </div>\n            <div class=\" my-1 flex justify-between\">\n              <span>angkatan: </span>\n               <input v-model=\"angkatan\" type=\"number\" placeholder=\"masukkan tahun keluar....\" class=\"px-1 border border-black text-sm\" alt=\"\">\n            </div>\n            <div class=\" my-1 flex justify-between flex-col\">\n              <span>kesan pesan</span>\n               <textarea v-model=\"kesan\" type=\"\" placeholder=\"masukkan quotes....\" class=\"px-1 border border-black text-sm\" alt=\"\"></textarea>\n            </div>\n            <div class=\" my-1 flex justify-between flex-col\">\n              <span>quotes </span>\n               <textarea v-model=\"quotes\" type=\"\" placeholder=\"masukkan quotes....\" class=\"px-1 border border-black text-sm\" alt=\"\"></textarea>\n            </div>\n            <div class=\" my-1 flex justify-between\">\n              <span>jabatan: </span>\n               <input v-model=\"jabatan\" type=\"text\" placeholder=\"(jabatan) at (perusahaan)\" class=\"px-1 border border-black text-sm\" alt=\"\">\n            </div>\n            <div class=\" my-1 flex justify-between flex-col\">\n              <div>\n                <span>upload foto </span> <span class=\" text-sm text-red-600 font-semibold\"> (foto persegi 1:1, <span class=\"text-black text-xs\">MAX 800Kb</span>) </span>\n              </div>\n              <input type=\"file\" accept=\"image/*\" class=\" border border-black\" ref=\"alumnibaru\">\n            </div>\n            <button @click=\"addAlumni\" :disabled=\"uploading == true\" class=\" bg-gray-300 px-2 py-1 mt-10 border-black border my-1 hover:bg-slate-200\">\n              <span v-if=\"uploading == true\">loading...</span>\n              <span v-if=\"uploading == false\">upload</span> \n            </button>\n          </div>\n        </section>\n      </div>\n      <!---->\n      <div class=\"mt-6 md:mt-20\">\n        <section class=\" text-lg font-bold py-2\">Hapus Alumni</section>\n        <section class=\"flex flex-col items-center justify-center\">\n          <div class=\"flex flex-col w-1/2\">\n            <div v-for=\"todo in todos\" :key=\"todo.id\" class=\"w-full border border-black my-4 p-1 flex flex-col justify-start items-start\">\n              <div>\n                <span>nama: </span>\n                <span>{{ todo.nama }}</span>\n              </div>\n              <div>\n                <span>angkatan: </span>\n                <span>{{ todo.angkatan }}</span>\n              </div>\n               <button @click=\"deleteAlumni(todo.id, todo.nama)\" class=\" w-3/4 self-center text-center bg-red-300 hover:bg-red-400\">hapus</button>\n            </div>\n        </div>\n        </section>\n      </div>\n    </div>\n  </template>\n  \n  <script>\n  import { doc, setDoc, deleteDoc, collection, onSnapshot } from 'firebase/firestore'\n  import db from '../utilities/firebase.js'\n  import {storage} from \"../utilities/firebase.js\"\n  import { ref, uploadBytes, deleteObject} from \"firebase/storage\"\n  import { useCollection } from 'vuefire'\n\n  \n  export default{\n    name:'UDAlumni',\n    components:{\n\n    },\n    setup(){\n      const todos = useCollection(collection(db, 'alumni'));\n      console.log(Object.keys(todos).length);\n      return{todos}\n    },\n\n    data(){\n      return{\n        jumlahAlumni: '',\n        nama: '',\n        panggilan: '',\n        angkatan: '',\n        kesan: '',\n        quotes: '',\n        jabatan: '',\n        uploading: false,\n\n      }\n    },\n\n    created() {\n      this.getAlumni()\n    },\n\n    methods:{\n      getAlumni(){\n        onSnapshot(doc(db, \"jumlah\", \"jumlah_alumni\"), (doc) => {\n          this.jumlahAlumni = doc.data().jumlah;\n        });\n      },\n        \n      async addAlumni() {\n          this.uploading = true;\n          if(this.nama == \" \" ||this.panggilan == ''|| this.angkatan == ''|| this.kesan == ''|| this.$refs.alumnibaru.value == null || this.$refs.alumnibaru.value == \"\"){\n            alert('nilai tidak dapat kosong');\n            this.uploading = false\n          }else if (this.$refs.alumnibaru.files[0].size > 800 * 800) {\n            //e.preventDefault();\n            alert('File terlalu besar (> 800Kb)');\n            this.uploading = false\n          }else{\n            // add new alumni \n            await setDoc(doc(db, \"jumlah\", \"jumlah_alumni\"), {\n                jumlah: this.jumlahAlumni + 1\n            }, { merge: true });\n          \n            let x = (this.jumlahAlumni).toString();\n            await setDoc(doc(db, \"alumni\", x), {\n                nama: this.nama,\n                panggilan: this.panggilan,\n                angkatan: this.angkatan,\n                potong: this.angkatan.toString().slice(-2),\n                kesan: this.kesan,\n                quotes: this.quotes,\n                jabatan: this.jabatan\n            }, { merge: true });\n          \n            const storageRef = ref(storage, 'alumni/'+x);\n            uploadBytes(storageRef, this.$refs.alumnibaru.files[0]).then(()=>{console.log(\"uploaded\")})\n            this.nama= \"\",\n            this.panggilan= '',\n            this.angkatan= ''\n            this.kesan= ''\n            this.quotes= ''\n            this.jabatan= ''\n            this.$refs.alumnibaru.value = null;\n\n            alert('new alumni uploaded')\n            this.uploading = false\n          }\n      },\n      async deleteAlumni(y, nama){  \n        if (confirm('menghapus:  ' + nama.toUpperCase()) == true) {\n          let z = y.toString()\n          await deleteDoc(doc(db, \"alumni\", z))\n          deleteObject(ref(storage, 'alumni/'+z)).then(() => {\n              // File deleted successfully\n          }).catch((error) => {\n              console.log(error);\n              alert('gagal, silahkan coba lagi');\n          });\n        } \n      }\n    }\n  }\n  </script>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}