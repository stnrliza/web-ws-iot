{"ast":null,"code":"import { doc, setDoc, getDoc, onSnapshot, deleteDoc } from 'firebase/firestore';\nimport db from '../utilities/firebase.js';\nimport { storage } from \"../utilities/firebase.js\";\nimport { ref, uploadBytes, deleteObject } from \"firebase/storage\";\nexport default {\n  name: 'UDAlumni',\n  components: {},\n  data() {\n    return {\n      jumlahAlumni: '',\n      nama: '',\n      panggilan: '',\n      angkatan: '',\n      kesan: '',\n      quotes: '',\n      jabatan: '',\n      namaLama: [{}],\n      angkatanLama: [{}]\n    };\n  },\n  created() {\n    this.getAlumni();\n    this.getNamaAlumni();\n  },\n  methods: {\n    getAlumni() {\n      onSnapshot(doc(db, \"alumni\", \"jumlah\"), doc => {\n        this.jumlahAlumni = doc.data().jumlah;\n        console.log(this.jumlahAlumni);\n      });\n    },\n    async getNamaAlumni() {\n      for (let i = 0; i < 4; i++) {\n        let j = i + 1;\n        let s = j.toString();\n        let p = (j + 1).toString();\n        const docSnap = await getDoc(doc(db, \"alumni\", s));\n        if (docSnap.exists()) {\n          // if(docSnap.data().nama !== undefined) {\n          this.namaLama[s] = docSnap.data().nama;\n          this.angkatanLama[s] = docSnap.data().angkatan;\n          console.log(s + this.namaLama[s]);\n          //  }\n        } else {\n          this.namaLama[s] = await getDoc(doc(db, \"alumni\", p)).data().nama;\n          console.log(s + this.namaLama[s]);\n        }\n      }\n    },\n    async addAlumni() {\n      // add new alumni \n      await setDoc(doc(db, \"alumni\", \"jumlah\"), {\n        jumlah: this.jumlahAlumni + 1\n      }, {\n        merge: true\n      });\n      let x = (this.jumlahAlumni + 1).toString();\n      await setDoc(doc(db, \"alumni\", x), {\n        nama: this.nama,\n        panggilan: this.panggilan,\n        angkatan: this.angkatan,\n        kesan: this.kesan,\n        quotes: this.quotes,\n        jabatan: this.jabatan\n      }, {\n        merge: true\n      });\n      const storageRef = ref(storage, 'alumni/' + x);\n      uploadBytes(storageRef, this.$refs.alumnibaru.files[0]).then(() => {\n        console.log(\"uploaded\");\n      });\n      this.nama = \"\", this.panggilan = '', this.angkatan = '';\n      this.kesan = '';\n      this.quotes = '';\n      this.jabatan = '';\n      this.$refs.alumnibaru.value = null;\n      alert('new alumni uploaded');\n      location.reload();\n    },\n    async deleteAlumni(y) {\n      await setDoc(doc(db, \"alumni\", \"jumlah\"), {\n        jumlah: this.jumlahAlumni - 1\n      }, {\n        merge: true\n      });\n      let z = y.toString();\n      await deleteDoc(doc(db, \"alumni\", z));\n      deleteObject(ref(storage, 'alumni/' + z)).then(() => {\n        // File deleted successfully\n        location.reload();\n      }).catch(error => {\n        console.log(error);\n      });\n      location.reload();\n    }\n  }\n};","map":{"version":3,"names":["doc","setDoc","getDoc","onSnapshot","deleteDoc","db","storage","ref","uploadBytes","deleteObject","name","components","data","jumlahAlumni","nama","panggilan","angkatan","kesan","quotes","jabatan","namaLama","angkatanLama","created","getAlumni","getNamaAlumni","methods","jumlah","console","log","i","j","s","toString","p","docSnap","exists","addAlumni","merge","x","storageRef","$refs","alumnibaru","files","then","value","alert","location","reload","deleteAlumni","y","z","catch","error"],"sources":["D:\\rafi\\koding\\vue3\\WEBIOT\\iotub\\src\\views\\UDAlumni.vue"],"sourcesContent":["<template>\r\n    <div class=\" w-1/2\">\r\n      <div class=\" pt-10 pb-5\">\r\n        <section class=\" text-3xl\">ALUMNI</section>\r\n      </div>\r\n      <div>\r\n        <section class=\" text-lg font-bold py-2\">Tambahkan Alumni Baru</section>\r\n        <section class=\"flex flex-col items-center justify-center\">\r\n          <div class=\"flex flex-col\">\r\n            <div class=\" my-1 flex justify-between\">\r\n              <span>nama: </span>\r\n               <input v-model=\"this.nama\" type=\"text\" placeholder=\"masukkan nama lengkap....\" class=\"px-1 border border-black text-sm\" alt=\"\">\r\n            </div>\r\n            <div class=\" my-1 flex justify-between\">\r\n              <span>panggilan: </span>\r\n               <input v-model=\"this.panggilan\" type=\"text\" placeholder=\"masukkan nama panggilan....\" class=\"px-1 border border-black text-sm\" alt=\"\">\r\n            </div>\r\n            <div class=\" my-1 flex justify-between\">\r\n              <span>angkatan: </span>\r\n               <input v-model=\"angkatan\" type=\"number\" placeholder=\"masukkan tahun keluar....\" class=\"px-1 border border-black text-sm\" alt=\"\">\r\n            </div>\r\n            <div class=\" my-1 flex justify-between flex-col\">\r\n              <span>kesan pesan</span>\r\n               <textarea v-model=\"kesan\" type=\"\" placeholder=\"masukkan quotes....\" class=\"px-1 border border-black text-sm\" alt=\"\"></textarea>\r\n            </div>\r\n            <div class=\" my-1 flex justify-between flex-col\">\r\n              <span>quotes </span>\r\n               <textarea v-model=\"quotes\" type=\"\" placeholder=\"masukkan quotes....\" class=\"px-1 border border-black text-sm\" alt=\"\"></textarea>\r\n            </div>\r\n            <div class=\" my-1 flex justify-between\">\r\n              <span>jabatan: </span>\r\n               <input v-model=\"jabatan\" type=\"text\" placeholder=\"(jabatan) at (perusahaan)\" class=\"px-1 border border-black text-sm\" alt=\"\">\r\n            </div>\r\n            <div class=\" my-1 flex justify-between flex-col\">\r\n              <span>upload foto </span>\r\n              <input type=\"file\" class=\" border border-black\" ref=\"alumnibaru\">\r\n            </div>\r\n            <button @click=\"addAlumni\" class=\" bg-gray-300 px-2 py-1 mt-10 border-black border my-1 hover:bg-slate-200\">upload</button>\r\n        </div>\r\n        </section>\r\n      </div>\r\n      <!---->\r\n      <div class=\" mt-20\">\r\n        <section class=\" text-lg font-bold py-2\">Hapus Alumni</section>\r\n        <section class=\"flex flex-col items-center justify-center\">\r\n          <div class=\"flex flex-col w-1/2\">\r\n            <div v-for=\"jumlah in jumlahAlumni\" :key=\"jumlah\" class=\"w-full border border-black my-4 p-1 flex flex-col justify-start items-start\">\r\n              <div>\r\n                <span>nama: </span>\r\n                <span>{{ this.namaLama[jumlah] }}</span>\r\n              </div>\r\n              <div>\r\n                <span>angkatan: </span>\r\n                <span>{{ this.angkatanLama[jumlah] }}</span>\r\n              </div>\r\n               <button @click=\"deleteAlumni(jumlah)\" class=\" w-3/4 self-center text-center bg-red-300 hover:bg-red-400\">hapus</button>\r\n            </div>\r\n        </div>\r\n        </section>\r\n      </div>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import { doc, setDoc, getDoc, onSnapshot, deleteDoc } from 'firebase/firestore'\r\n  import db from '../utilities/firebase.js'\r\n  import {storage} from \"../utilities/firebase.js\"\r\n  import { ref, uploadBytes, deleteObject} from \"firebase/storage\"\r\n  \r\n  export default{\r\n    name:'UDAlumni',\r\n    components:{\r\n  \r\n    },\r\n    data(){\r\n      return{\r\n        jumlahAlumni: '',\r\n        nama: '',\r\n        panggilan: '',\r\n        angkatan: '',\r\n        kesan: '',\r\n        quotes: '',\r\n        jabatan: '',\r\n        namaLama: [{}],\r\n        angkatanLama: [{}],\r\n      };\r\n    },\r\n\r\n    created() {\r\n      this.getAlumni();\r\n      this.getNamaAlumni();\r\n    },\r\n    \r\n    methods:{\r\n        \r\n      getAlumni() {\r\n        onSnapshot(doc(db, \"alumni\", \"jumlah\"), (doc) => {\r\n                        this.jumlahAlumni = doc.data().jumlah;\r\n                        console.log(this.jumlahAlumni);\r\n                });\r\n            },\r\n        async getNamaAlumni(){\r\n            for (let i = 0; i < 4; i++) {\r\n                let j = i + 1;\r\n                let s = j.toString();\r\n                let p  = (j+1).toString();\r\n                const docSnap = await getDoc(doc(db, \"alumni\", s));\r\n                if (docSnap.exists()) {\r\n                   // if(docSnap.data().nama !== undefined) {\r\n                        this.namaLama[s] = docSnap.data().nama;\r\n                        this.angkatanLama[s] = docSnap.data().angkatan; \r\n                        console.log(s+ this.namaLama[s])\r\n                  //  }\r\n                }\r\n                else{\r\n                    this.namaLama[s] = await getDoc(doc(db, \"alumni\", p)).data().nama;\r\n                    console.log(s+ this.namaLama[s])\r\n                }\r\n            }\r\n        },\r\n        \r\n      \r\n      async addAlumni() {\r\n          // add new alumni \r\n          await setDoc(doc(db, \"alumni\", \"jumlah\"), {\r\n              jumlah: this.jumlahAlumni + 1\r\n          }, { merge: true });\r\n        \r\n          let x = (this.jumlahAlumni+1).toString();\r\n          await setDoc(doc(db, \"alumni\", x), {\r\n              nama: this.nama,\r\n              panggilan: this.panggilan,\r\n              angkatan: this.angkatan,\r\n              kesan: this.kesan,\r\n              quotes: this.quotes,\r\n              jabatan: this.jabatan\r\n          }, { merge: true });\r\n\r\n          const storageRef = ref(storage, 'alumni/'+x);\r\n            uploadBytes(storageRef, this.$refs.alumnibaru.files[0]).then(()=>{console.log(\"uploaded\")})\r\n        \r\n            this.nama= \"\",\r\n            this.panggilan= '',\r\n            this.angkatan= ''\r\n            this.kesan= ''\r\n            this.quotes= ''\r\n            this.jabatan= ''\r\n            this.$refs.alumnibaru.value = null;\r\n\r\n            alert('new alumni uploaded')\r\n            location.reload()\r\n      },\r\n      async deleteAlumni(y){\r\n        await setDoc(doc(db, \"alumni\", \"jumlah\"), {\r\n              jumlah: this.jumlahAlumni - 1\r\n          }, { merge: true });\r\n          \r\n        let z = y.toString()\r\n        await deleteDoc(doc(db, \"alumni\", z))\r\n\r\n        deleteObject(ref(storage, 'alumni/'+z)).then(() => {\r\n        // File deleted successfully\r\n        location.reload()\r\n        }).catch((error) => {\r\n            console.log(error);\r\n        });\r\n        location.reload()\r\n      }\r\n    }\r\n  }\r\n  </script>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}