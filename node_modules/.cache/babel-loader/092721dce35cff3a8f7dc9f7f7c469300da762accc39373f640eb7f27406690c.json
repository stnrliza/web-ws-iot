{"ast":null,"code":"import { doc, onSnapshot, setDoc, deleteDoc } from 'firebase/firestore';\nimport db from '../utilities/firebase.js';\nimport { storage } from \"../utilities/firebase.js\";\nimport { ref, uploadBytes, deleteObject } from \"firebase/storage\";\nexport default {\n  name: 'UDPrestasi',\n  components: {},\n  data() {\n    return {\n      jumlahPrestasi: '',\n      nama: '',\n      lomba: ''\n    };\n  },\n  created() {\n    this.getPrestasi();\n  },\n  methods: {\n    getPrestasi() {\n      onSnapshot(doc(db, \"jumlah\", \"jumlah_prestasi\"), doc => {\n        this.jumlahPrestasi = doc.data().jumlah;\n      });\n    },\n    async addPrestasi() {\n      // add new alumni \n      await setDoc(doc(db, \"jumlah\", \"jumlah_prestasi\"), {\n        jumlah: this.jumlahPrestasi + 1\n      }, {\n        merge: true\n      });\n      let x = this.jumlahPrestasi.toString();\n      await setDoc(doc(db, \"prestasi\", x), {\n        nama: this.nama,\n        lomba: this.lomba\n      }, {\n        merge: true\n      });\n      const storageRef = ref(storage, 'prestasi/' + x);\n      uploadBytes(storageRef, this.$refs.prestasibaru.files[0]).then(() => {\n        console.log(\"new prestasi uploaded\");\n      });\n      this.nama = \"\", this.lomba = '', this.$refs.prestasibaru.value = null;\n      alert('new prestasi uploaded');\n    },\n    async deletePrestasi(y) {\n      let z = y.toString();\n      await deleteDoc(doc(db, \"prestasi\", z));\n      deleteObject(ref(storage, 'prestasi/' + z)).then(() => {\n        // File deleted successfully\n        alert(\"prestasi deleted\");\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n  }\n};","map":{"version":3,"names":["doc","onSnapshot","setDoc","deleteDoc","db","storage","ref","uploadBytes","deleteObject","name","components","data","jumlahPrestasi","nama","lomba","created","getPrestasi","methods","jumlah","addPrestasi","merge","x","toString","storageRef","$refs","prestasibaru","files","then","console","log","value","alert","deletePrestasi","y","z","catch","error"],"sources":["D:\\rafi\\koding\\vue3\\WEBIOT\\iotub\\src\\views\\UDPrestasi.vue"],"sourcesContent":["<template>\r\n    <div class=\"w-1/2\">\r\n      <div class=\" pt-10 pb-5\">\r\n        <section class=\" text-3xl\">PRESTASI</section>\r\n      </div>\r\n      <div>\r\n        <section class=\" text-lg font-bold py-2\">Tambahkan Prestasi Baru</section>\r\n        <section class=\"flex flex-col items-center justify-center\">\r\n          <form action=\"\" class=\"flex flex-col\">\r\n            <div class=\" my-1 flex justify-between\">\r\n              <span>nama: </span>\r\n               <input type=\"text\" placeholder=\"nama1, nama2, nama3, ...\" class=\"px-1 border border-black\" alt=\"\">\r\n            </div>\r\n            <div class=\" my-1 flex justify-between\">\r\n              <span>lomba: </span>\r\n               <input type=\"text\" placeholder=\"masukkan nama lomba....\" class=\"px-1 border border-black\" alt=\"\">\r\n            </div>\r\n            <div class=\" my-1 flex justify-between flex-col\">\r\n              <span>upload foto </span>\r\n              <input type=\"file\" class=\" border border-black\" ref=\"prestasibaru\">\r\n            </div>\r\n            <button @click=\"upload\" class=\" bg-gray-300 px-2 py-1 mt-10 border-black border my-1 hover:bg-slate-200\">upload</button>\r\n          </form>\r\n        </section>\r\n      </div>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import { doc, onSnapshot, setDoc, deleteDoc } from 'firebase/firestore'\r\n  import db from '../utilities/firebase.js'\r\n  import {storage} from \"../utilities/firebase.js\"\r\n  import { ref, uploadBytes, deleteObject} from \"firebase/storage\"\r\n  \r\n  export default{\r\n    name:'UDPrestasi',\r\n    components:{\r\n  \r\n    },\r\n    data(){\r\n      return{\r\n        jumlahPrestasi: '',\r\n        nama: '',\r\n        lomba: '',\r\n      };\r\n    },\r\n    created() {\r\n      this.getPrestasi()\r\n    },\r\n    \r\n    methods:{\r\n      getPrestasi(){\r\n        onSnapshot(doc(db, \"jumlah\", \"jumlah_prestasi\"), (doc) => {\r\n          this.jumlahPrestasi = doc.data().jumlah;\r\n        });\r\n      },\r\n\r\n      async addPrestasi() {\r\n          // add new alumni \r\n          await setDoc(doc(db, \"jumlah\", \"jumlah_prestasi\"), {\r\n              jumlah: this.jumlahPrestasi + 1\r\n          }, { merge: true });\r\n        \r\n          let x = (this.jumlahPrestasi).toString();\r\n          await setDoc(doc(db, \"prestasi\", x), {\r\n              nama: this.nama,\r\n              lomba: this.lomba\r\n          }, { merge: true });\r\n         \r\n          const storageRef = ref(storage, 'prestasi/'+x);\r\n          uploadBytes(storageRef, this.$refs.prestasibaru.files[0]).then(()=>{console.log(\"new prestasi uploaded\")})\r\n          this.nama= \"\",\r\n          this.lomba= '',\r\n          this.$refs.prestasibaru.value = null;\r\n\r\n          alert('new prestasi uploaded')\r\n      },\r\n\r\n      async deletePrestasi(y){  \r\n        let z = y.toString()\r\n        await deleteDoc(doc(db, \"prestasi\", z))\r\n        deleteObject(ref(storage, 'prestasi/'+z)).then(() => {\r\n            // File deleted successfully\r\n            alert(\"prestasi deleted\");\r\n        }).catch((error) => {\r\n            console.log(error);\r\n        });\r\n      }\r\n    }\r\n  }\r\n  </script>"],"mappings":"AA6BE,SAASA,GAAG,EAAEC,UAAU,EAAEC,MAAM,EAAEC,SAAQ,QAAS,oBAAmB;AACtE,OAAOC,EAAC,MAAO,0BAAyB;AACxC,SAAQC,OAAO,QAAO,0BAAyB;AAC/C,SAASC,GAAG,EAAEC,WAAW,EAAEC,YAAY,QAAO,kBAAiB;AAE/D,eAAc;EACZC,IAAI,EAAC,YAAY;EACjBC,UAAU,EAAC,CAEX,CAAC;EACDC,IAAIA,CAAA,EAAE;IACJ,OAAM;MACJC,cAAc,EAAE,EAAE;MAClBC,IAAI,EAAE,EAAE;MACRC,KAAK,EAAE;IACT,CAAC;EACH,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,WAAW,CAAC;EACnB,CAAC;EAEDC,OAAO,EAAC;IACND,WAAWA,CAAA,EAAE;MACXf,UAAU,CAACD,GAAG,CAACI,EAAE,EAAE,QAAQ,EAAE,iBAAiB,CAAC,EAAGJ,GAAG,IAAK;QACxD,IAAI,CAACY,cAAa,GAAIZ,GAAG,CAACW,IAAI,CAAC,CAAC,CAACO,MAAM;MACzC,CAAC,CAAC;IACJ,CAAC;IAED,MAAMC,WAAWA,CAAA,EAAG;MAChB;MACA,MAAMjB,MAAM,CAACF,GAAG,CAACI,EAAE,EAAE,QAAQ,EAAE,iBAAiB,CAAC,EAAE;QAC/Cc,MAAM,EAAE,IAAI,CAACN,cAAa,GAAI;MAClC,CAAC,EAAE;QAAEQ,KAAK,EAAE;MAAK,CAAC,CAAC;MAEnB,IAAIC,CAAA,GAAK,IAAI,CAACT,cAAc,CAAEU,QAAQ,CAAC,CAAC;MACxC,MAAMpB,MAAM,CAACF,GAAG,CAACI,EAAE,EAAE,UAAU,EAAEiB,CAAC,CAAC,EAAE;QACjCR,IAAI,EAAE,IAAI,CAACA,IAAI;QACfC,KAAK,EAAE,IAAI,CAACA;MAChB,CAAC,EAAE;QAAEM,KAAK,EAAE;MAAK,CAAC,CAAC;MAEnB,MAAMG,UAAS,GAAIjB,GAAG,CAACD,OAAO,EAAE,WAAW,GAACgB,CAAC,CAAC;MAC9Cd,WAAW,CAACgB,UAAU,EAAE,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,MAAI;QAACC,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC;MAAA,CAAC;MACzG,IAAI,CAAChB,IAAI,GAAE,EAAE,EACb,IAAI,CAACC,KAAK,GAAE,EAAE,EACd,IAAI,CAACU,KAAK,CAACC,YAAY,CAACK,KAAI,GAAI,IAAI;MAEpCC,KAAK,CAAC,uBAAuB;IACjC,CAAC;IAED,MAAMC,cAAcA,CAACC,CAAC,EAAC;MACrB,IAAIC,CAAA,GAAID,CAAC,CAACX,QAAQ,CAAC;MACnB,MAAMnB,SAAS,CAACH,GAAG,CAACI,EAAE,EAAE,UAAU,EAAE8B,CAAC,CAAC;MACtC1B,YAAY,CAACF,GAAG,CAACD,OAAO,EAAE,WAAW,GAAC6B,CAAC,CAAC,CAAC,CAACP,IAAI,CAAC,MAAM;QACjD;QACAI,KAAK,CAAC,kBAAkB,CAAC;MAC7B,CAAC,CAAC,CAACI,KAAK,CAAEC,KAAK,IAAK;QAChBR,OAAO,CAACC,GAAG,CAACO,KAAK,CAAC;MACtB,CAAC,CAAC;IACJ;EACF;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}